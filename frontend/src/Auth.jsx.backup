import { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import { motion } from "framer-motion";
import { signInWithEmail, signUpWithEmail, resetPassword, onAuthStateChange } from './firebase';
import { useTheme } from "./ThemeContext";

function Auth({ setUser, setToken }) {
Â  const [email, setEmail] = useState("");
Â  const [password, setPassword] = useState("");
Â  const [name, setName] = useState("");
Â  const [isLogin, setIsLogin] = useState(true);
Â  const [message, setMessage] = useState("");
Â  const [isLoading, setIsLoading] = useState(false);
Â  const [showForgotPassword, setShowForgotPassword] = useState(false);
Â  const [newPassword, setNewPassword] = useState("");
Â  const [confirmPassword, setConfirmPassword] = useState("");
Â  const navigate = useNavigate();
Â  const { theme } = useTheme();

Â  // Listen for Firebase auth state changes
  useEffect(() => {
    const unsubscribe = onAuthStateChange((user) => {
      if (user) {
        // User is signed in
        setUser(user);
        user.getIdToken().then(token => {
          setToken(token);
          localStorage.setItem('token', token);
          localStorage.setItem('user', JSON.stringify(user));
        });
      } else {
        // User is signed out
        setUser(null);
        setToken(null);
        localStorage.removeItem('token');
        localStorage.removeItem('user');
      }
    });

    return () => unsubscribe();
  }, [setUser, setToken]);

Â  const [authStatus, setAuthStatus] = useState('idle'); // idle, loading, success, error

Â  const handleAuth = async () => {
    setIsLoading(true);
Â  Â  setMessage("");
Â  Â  setAuthStatus('loading');

Â  Â  try {
Â  Â  Â  if (isLogin) {
Â  Â  Â  Â  // Login - Try backend first, fallback to localStorage
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const response = await axios.post(`${API_URL}/login`, { email, password });
Â  Â  Â  Â  Â  const { user, token } = response.data;

Â  Â  Â  Â  Â  setUser(user);
Â  Â  Â  Â  Â  setToken(token);
Â  Â  Â  Â  Â  localStorage.setItem('token', token);
Â  Â  Â  Â  Â  localStorage.setItem('user', JSON.stringify(user));

Â  Â  Â  Â  Â  setAuthStatus('success');
Â  Â  Â  Â  Â  setMessage("âœ… Welcome back! Redirecting...");

Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  navigate("/");
Â  Â  Â  Â  Â  }, 1000);

Â  Â  Â  Â  } catch (backendError) {
Â  Â  Â  Â  Â  // Backend unavailable - use localStorage fallback
Â  Â  Â  Â  Â  console.log('Backend unavailable, using localStorage authentication');
Â  Â  Â  Â  Â  const storedUsers = JSON.parse(localStorage.getItem('offline_users') || '[]');
Â  Â  Â  Â  Â  const foundUser = storedUsers.find(u => u.email === email && u.password === password);

Â  Â  Â  Â  Â  if (foundUser) {
Â  Â  Â  Â  Â  Â  const mockToken = 'offline_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
Â  Â  Â  Â  Â  Â  const userData = {
Â  Â  Â  Â  Â  Â  Â  _id: foundUser.id,
Â  Â  Â  Â  Â  Â  Â  email: foundUser.email,
Â  Â  Â  Â  Â  Â  Â  name: foundUser.name,
Â  Â  Â  Â  Â  Â  Â  level: foundUser.level || 1,
Â  Â  Â  Â  Â  Â  Â  xp: foundUser.xp || 0,
Â  Â  Â  Â  Â  Â  Â  streak: foundUser.streak || 0,
Â  Â  Â  Â  Â  Â  Â  tasksCompleted: foundUser.tasksCompleted || 0
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  setUser(userData);
Â  Â  Â  Â  Â  Â  setToken(mockToken);
Â  Â  Â  Â  Â  Â  localStorage.setItem('token', mockToken);
Â  Â  Â  Â  Â  Â  localStorage.setItem('user', JSON.stringify(userData));

Â  Â  Â  Â  Â  Â  setAuthStatus('success');
Â  Â  Â  Â  Â  Â  setMessage("âœ… Signed in successfully! Redirecting...");

Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  navigate("/");
Â  Â  Â  Â  Â  Â  }, 1000);

Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  setMessage("âŒ Invalid email or password. Please try again or create an account.");
Â  Â  Â  Â  Â  Â  setAuthStatus('error');
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  } else {
Â  Â  Â  Â  // Register
Â  Â  Â  Â  if (password.length < 6) {
Â  Â  Â  Â  Â  setMessage("âŒ Password must be at least 6 characters");
Â  Â  Â  Â  Â  setAuthStatus('error');
Â  Â  Â  Â  Â  setIsLoading(false);
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  if (!name.trim()) {
Â  Â  Â  Â  Â  setMessage("âŒ Name is required");
Â  Â  Â  Â  Â  setAuthStatus('error');
Â  Â  Â  Â  Â  setIsLoading(false);
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Try backend first, fallback to localStorage
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const response = await axios.post(`${API_URL}/register`, {
Â  Â  Â  Â  Â  Â  email,
Â  Â  Â  Â  Â  Â  password,
Â  Â  Â  Â  Â  Â  name: name.trim()
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  const { user, token } = response.data;

Â  Â  Â  Â  Â  setUser(user);
Â  Â  Â  Â  Â  setToken(token);
Â  Â  Â  Â  Â  localStorage.setItem('token', token);
Â  Â  Â  Â  Â  localStorage.setItem('user', JSON.stringify(user));

Â  Â  Â  Â  Â  setAuthStatus('success');
Â  Â  Â  Â  Â  setMessage("âœ… Account created successfully! Redirecting...");

Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  navigate("/");
Â  Â  Â  Â  Â  }, 1000);

Â  Â  Â  Â  } catch (backendError) {
Â  Â  Â  Â  Â  // Backend unavailable - use localStorage fallback
Â  Â  Â  Â  Â  console.log('Backend unavailable, creating offline account');
Â  Â  Â  Â  Â  const storedUsers = JSON.parse(localStorage.getItem('offline_users') || '[]');

Â  Â  Â  Â  Â  // Check if email already exists
Â  Â  Â  Â  Â  if (storedUsers.find(u => u.email === email)) {
Â  Â  Â  Â  Â  Â  setMessage("âŒ Email already registered. Please sign in.");
Â  Â  Â  Â  Â  Â  setAuthStatus('error');
Â  Â  Â  Â  Â  Â  setIsLoading(false);
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  const newUser = {
Â  Â  Â  Â  Â  Â  id: 'offline_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
Â  Â  Â  Â  Â  Â  email,
Â  Â  Â  Â  Â  Â  password, // In production, this should be hashed
Â  Â  Â  Â  Â  Â  name: name.trim(),
Â  Â  Â  Â  Â  Â  level: 1,
Â  Â  Â  Â  Â  Â  xp: 0,
Â  Â  Â  Â  Â  Â  streak: 0,
Â  Â  Â  Â  Â  Â  tasksCompleted: 0,
Â  Â  Â  Â  Â  Â  createdAt: new Date().toISOString()
Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  storedUsers.push(newUser);
Â  Â  Â  Â  Â  localStorage.setItem('offline_users', JSON.stringify(storedUsers));

Â  Â  Â  Â  Â  const mockToken = 'offline_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
Â  Â  Â  Â  Â  const userData = {
Â  Â  Â  Â  Â  Â  _id: newUser.id,
Â  Â  Â  Â  Â  Â  email: newUser.email,
Â  Â  Â  Â  Â  Â  name: newUser.name,
Â  Â  Â  Â  Â  Â  level: 1,
Â  Â  Â  Â  Â  Â  xp: 0,
Â  Â  Â  Â  Â  Â  streak: 0,
Â  Â  Â  Â  Â  Â  tasksCompleted: 0
Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  setUser(userData);
Â  Â  Â  Â  Â  setToken(mockToken);
Â  Â  Â  Â  Â  localStorage.setItem('token', mockToken);
Â  Â  Â  Â  Â  localStorage.setItem('user', JSON.stringify(userData));

Â  Â  Â  Â  Â  setAuthStatus('success');
Â  Â  Â  Â  Â  setMessage("âœ… Account created successfully! Redirecting...");

Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  navigate("/");
Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  } catch (err) {
Â  Â  Â  const errorMessage = err.response?.data?.error || 'âŒ Authentication failed. Please check your connection and try again.';
Â  Â  Â  setMessage(errorMessage);
Â  Â  Â  setAuthStatus('error');
Â  Â  Â  console.error('Auth error:', err);
Â  Â  } finally {
Â  Â  Â  setIsLoading(false);
Â  Â  }
Â  };

Â  const handleLogout = () => {
Â  Â  localStorage.removeItem('token');
Â  Â  setUser(null);
Â  Â  setToken(null);
Â  Â  navigate("/auth");
Â  };

Â  const handleForgotPassword = async () => {
Â  Â  if (!resetEmail) {
Â  Â  Â  setMessage("Please enter your email address");
Â  Â  Â  return;
Â  Â  }

Â  Â  if (!newPassword || !confirmPassword) {
Â  Â  Â  setMessage("Please enter and confirm your new password");
Â  Â  Â  return;
Â  Â  }

Â  Â  if (newPassword.length < 6) {
Â  Â  Â  setMessage("Password must be at least 6 characters");
Â  Â  Â  return;
Â  Â  }

Â  Â  if (newPassword !== confirmPassword) {
Â  Â  Â  setMessage("Passwords do not match");
Â  Â  Â  return;
Â  Â  }

Â  Â  setIsLoading(true);
Â  Â  setMessage("");

Â  Â  try {
Â  Â  Â  // Try backend first
Â  Â  Â  try {
Â  Â  Â  Â  const response = await axios.post(`${API_URL}/reset-password`, {
Â  Â  Â  Â  Â  email: resetEmail,
Â  Â  Â  Â  Â  newPassword: newPassword
Â  Â  Â  Â  });

Â  Â  Â  Â  if (response.data.success) {
Â  Â  Â  Â  Â  setMessage("âœ… Password reset successful! You can now sign in with your new password.");
Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  setShowForgotPassword(false);
Â  Â  Â  Â  Â  Â  setResetEmail("");
Â  Â  Â  Â  Â  Â  setNewPassword("");
Â  Â  Â  Â  Â  Â  setConfirmPassword("");
Â  Â  Â  Â  Â  Â  setMessage("");
Â  Â  Â  Â  Â  }, 3000);
Â  Â  Â  Â  }
Â  Â  Â  } catch (backendError) {
Â  Â  Â  Â  // Backend unavailable - use localStorage fallback
Â  Â  Â  Â  console.log('Backend unavailable, using localStorage for password reset');
Â  Â  Â  Â  const storedUsers = JSON.parse(localStorage.getItem('offline_users') || '[]');
Â  Â  Â  Â  const userIndex = storedUsers.findIndex(u => u.email === resetEmail);

Â  Â  Â  Â  if (userIndex === -1) {
Â  Â  Â  Â  Â  setMessage("âŒ No account found with this email address.");
Â  Â  Â  Â  Â  setIsLoading(false);
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Update password in localStorage
Â  Â  Â  Â  storedUsers[userIndex].password = newPassword;
Â  Â  Â  Â  localStorage.setItem('offline_users', JSON.stringify(storedUsers));

Â  Â  Â  Â  setMessage("âœ… Password reset successful! You can now sign in with your new password.");
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  setShowForgotPassword(false);
Â  Â  Â  Â  Â  setResetEmail("");
Â  Â  Â  Â  Â  Â  setNewPassword("");
Â  Â  Â  Â  Â  Â  setConfirmPassword("");
Â  Â  Â  Â  Â  Â  setMessage("");
Â  Â  Â  Â  Â  }, 3000);
Â  Â  Â  }
Â  Â  } catch (error) {
Â  Â  Â  setMessage("âŒ Failed to reset password. Please try again.");
Â  Â  } finally {
Â  Â  Â  setIsLoading(false);
Â  Â  }
Â  };

Â  return (
Â  Â  <div
Â  Â  Â  style={{
Â  Â  Â  Â  minHeight: "100vh",
Â  Â  Â  Â  display: "flex",
Â  Â  Â  Â  justifyContent: "center",
Â  Â  Â  Â  alignItems: "center",
Â  Â  Â  Â  background: theme.background,
Â  Â  Â  Â  position: "relative",
Â  Â  Â  Â  overflow: "hidden",
        fontFamily: '"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',
Â  Â  Â  }}
Â  Â  >
Â  Â  Â  {/* Enhanced Animated Background Elements */}
Â  Â  Â  <div style={{
Â  Â  Â  Â  position: "absolute",
Â  Â  Â  Â  top: "10%",
Â  Â  Â  Â  left: "5%",
Â  Â  Â  Â  width: "300px",
Â  Â  Â  Â  height: "300px",
Â  Â  Â  Â  background: `radial-gradient(circle at 30% 20%, ${theme.accent}25 0%, ${theme.accentSecondary}15 40%, transparent 70%)`,
Â  Â  Â  Â  borderRadius: "50%",
Â  Â  Â  Â  animation: "float 40s ease-in-out infinite",
Â  Â  Â  Â  filter: "blur(120px)",
Â  Â  Â  }} />
Â  Â  Â  <div style={{
Â  Â  Â  Â  position: "absolute",
Â  Â  Â  Â  bottom: "10%",
Â  Â  Â  Â  right: "5%",
Â  Â  Â  Â  width: "250px",
Â  Â  Â  Â  height: "250px",
Â  Â  Â  Â  background: `radial-gradient(circle at 70% 80%, ${theme.accentSecondary}25 0%, ${theme.accent}15 40%, transparent 70%)`,
Â  Â  Â  Â  borderRadius: "50%",
Â  Â  Â  Â  animation: "float 45s ease-in-out infinite reverse",
Â  Â  Â  Â  filter: "blur(120px)",
Â  Â  Â  }} />
Â  Â  Â  <div style={{
Â  Â  Â  Â  position: "absolute",
Â  Â  Â  Â  top: "50%",
Â  Â  Â  Â  left: "50%",
Â  Â  Â  Â  transform: "translate(-50%, -50%)",
Â  Â  Â  Â  width: "400px",
Â  Â  Â  Â  height: "400px",
Â  Â  Â  Â  background: `conic-gradient(from 0deg, ${theme.accent}10, ${theme.accentSecondary}10, transparent, ${theme.accent}10)`,
Â  Â  Â  Â  borderRadius: "50%",
Â  Â  Â  Â  animation: "rotate 60s linear infinite",
Â  Â  Â  Â  filter: "blur(120px)",
Â  Â  Â  }} />

Â  Â  Â  <motion.div
Â  Â  Â  Â  initial={{ opacity: 0, scale: 0.8, y: 50 }}
Â  Â  Â  Â  animate={{ opacity: 1, scale: 1, y: 0 }}
Â  Â  Â  Â  transition={{ duration: 0.6, ease: "easeOut" }}
Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  background: theme.background === '#121212' ? 'rgba(30, 30, 30, 0.25)' : 'rgba(250, 250, 250, 0.3)',
Â  Â  Â  Â  Â  backdropFilter: "blur(40px) saturate(150%)",
Â  Â  Â  Â  Â  WebkitBackdropFilter: "blur(40px) saturate(150%)",
Â  Â  Â  Â  Â  padding: "50px 45px",
Â  Â  Â  Â  Â  borderRadius: "28px",
Â  Â  Â  Â  Â  width: "420px",
Â  Â  Â  Â  Â  textAlign: "center",
Â  Â  Â  Â  Â  boxShadow: '0 16px 60px rgba(0, 0, 0, 0.1)',
Â  Â  Â  Â  Â  border: `1px solid ${theme.border}`,
Â  Â  Â  Â  Â  position: "relative",
Â  Â  Â  Â  Â  zIndex: 1,
Â  Â  Â  Â  }}
Â  Â  Â  >
Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  initial={{ scale: 0 }}
Â  Â  Â  Â  Â  animate={{ scale: 1, rotate: 360 }}
Â  Â  Â  Â  Â  transition={{ duration: 0.8, delay: 0.2, type: "spring" }}
Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  fontSize: "3rem",
Â  Â  Â  Â  Â  Â  marginBottom: "20px",
Â  Â  Â  Â  Â  Â  filter: "drop-shadow(0 0 15px rgba(255, 255, 255, 0.3))",
Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  >
Â  Â  Â  Â  Â  {showForgotPassword ? "ğŸ”‘" : isLogin ? "ğŸ‘‹" : "âœ¨"}
Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  <h2
Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  fontSize: "2.25rem",
            background: 'none',
            WebkitBackgroundClip: 'unset',
            WebkitTextFillColor: 'unset',
            backgroundClip: 'unset',
            color: theme.textPrimary,
Â  Â  Â  Â  Â  Â  fontWeight: "700",
Â  Â  Â  Â  Â  Â  marginBottom: "10px",
Â  Â  Â  Â  Â  Â  letterSpacing: "-0.5px",
Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  >
Â  Â  Â  Â  Â  {showForgotPassword ? "Reset Password" : isLogin ? "Welcome Back" : "Create Account"}
Â  Â  Â  Â  </h2>
Â  Â  Â  Â  <p style={{
Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  color: theme.textSecondary,
Â  Â  Â  Â  Â  marginBottom: "35px",
Â  Â  Â  Â  Â  fontWeight: "400",
          maxWidth: '300px',
          margin: '0 auto 35px auto'
Â  Â  Â  Â  }}>
Â  Â  Â  Â  Â  {showForgotPassword
Â  Â  Â  Â  Â  Â  ? "Enter your email and choose a new password"
Â  Â  Â  Â  Â  Â  : isLogin
Â  Â  Â  Â  Â  Â  ? "Sign in to continue your growth journey"
Â  Â  Â  Â  Â  Â  : "Start your journey to daily growth"}
Â  Â  Â  Â  </p>

Â  Â  Â  Â  {!showForgotPassword && (
Â  Â  Â  Â  Â  <>
Â  Â  Â  Â  Â  Â  {!isLogin && (
Â  Â  Â  Â  Â  Â  Â  <motion.input
Â  Â  Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, x: -20 }}
Â  Â  Â  Â  Â  Â  Â  Â  animate={{ opacity: 1, x: 0 }}
Â  Â  Â  Â  Â  Â  Â  Â  exit={{ opacity: 0, x: 20 }}
Â  Â  Â  Â  Â  Â  Â  Â  whileFocus={{ scale: 1.02, boxShadow: `0 0 0 3px ${theme.accent}30` }}
Â  Â  Â  Â  Â  Â  Â  Â  type="text"
Â  Â  Â  Â  Â  Â  Â  Â  placeholder="Your name"
Â  Â  Â  Â  Â  Â  Â  Â  value={name}
Â  Â  Â  Â  Â  Â  Â  Â  onChange={(e) => setName(e.target.value)}
Â  Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  Â  width: "100%",
Â  Â  Â  Â  Â  Â  Â  Â  Â  padding: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  Â  marginBottom: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: "14px",
Â  Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  Â  Â  Â  Â  outline: "none",
Â  Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  Â  background: theme.background === '#121212' ? 'rgba(0, 0, 0, 0.15)' : 'rgba(0, 0, 0, 0.04)',
Â  Â  Â  Â  Â  Â  Â  Â  Â  color: theme.textPrimary,
Â  Â  Â  Â  Â  Â  Â  Â  Â  border: `1px solid ${theme.border}`,
Â  Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  />
Â  Â  Â  Â  Â  Â  )}

Â  Â  Â  Â  Â  Â  <motion.input
Â  Â  Â  Â  Â  Â  Â  whileFocus={{ scale: 1.02, boxShadow: `0 0 0 3px ${theme.accent}30` }}
Â  Â  Â  Â  Â  Â  Â  type="email"
Â  Â  Â  Â  Â  Â  Â  placeholder="Email address"
Â  Â  Â  Â  Â  Â  Â  value={email}
Â  Â  Â  Â  Â  Â  Â  onChange={(e) => setEmail(e.target.value)}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  width: "100%",
Â  Â  Â  Â  Â  Â  Â  Â  padding: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  marginBottom: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: "14px",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  Â  Â  Â  outline: "none",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  background: theme.background === '#121212' ? 'rgba(0, 0, 0, 0.15)' : 'rgba(0, 0, 0, 0.04)',
Â  Â  Â  Â  Â  Â  Â  Â  color: theme.textPrimary,
Â  Â  Â  Â  Â  Â  Â  Â  border: `1px solid ${theme.border}`,
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  />

Â  Â  Â  Â  Â  Â  <motion.input
Â  Â  Â  Â  Â  Â  Â  whileFocus={{ scale: 1.02, boxShadow: `0 0 0 3px ${theme.accent}30` }}
Â  Â  Â  Â  Â  Â  Â  type="password"
Â  Â  Â  Â  Â  Â  Â  placeholder="Password"
Â  Â  Â  Â  Â  Â  Â  value={password}
Â  Â  Â  Â  Â  Â  Â  onChange={(e) => setPassword(e.target.value)}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  width: "100%",
Â  Â  Â  Â  Â  Â  Â  Â  padding: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  marginBottom: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: "14px",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  Â  Â  Â  outline: "none",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  background: theme.background === '#121212' ? 'rgba(0, 0, 0, 0.15)' : 'rgba(0, 0, 0, 0.04)',
Â  Â  Â  Â  Â  Â  Â  Â  color: theme.textPrimary,
Â  Â  Â  Â  Â  Â  Â  Â  border: `1px solid ${theme.border}`,
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  />
Â  Â  Â  Â  Â  </>
Â  Â  Â  Â  )}

Â  Â  Â  Â  {!showForgotPassword ? (
Â  Â  Â  Â  Â  <>
Â  Â  Â  Â  Â  Â  <motion.button
Â  Â  Â  Â  Â  Â  Â  whileHover={{ scale: 1.05, boxShadow: `0 10px 40px ${theme.accent}40` }}
Â  Â  Â  Â  Â  Â  Â  whileTap={{ scale: 0.95 }}
Â  Â  Â  Â  Â  Â  Â  onClick={handleAuth}
Â  Â  Â  Â  Â  Â  Â  disabled={isLoading}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  width: "100%",
Â  Â  Â  Â  Â  Â  Â  Â  padding: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: "14px",
Â  Â  Â  Â  Â  Â  Â  Â  border: "none",
Â  Â  Â  Â  Â  Â  Â  Â  background: theme.accent,
Â  Â  Â  Â  Â  Â  Â  Â  color: "#fff",
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "600",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  Â  Â  Â  cursor: isLoading ? "not-allowed" : "pointer",
Â  Â  Â  Â  Â  Â  Â  Â  letterSpacing: "0.5px",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  opacity: isLoading ? 0.7 : 1,
Â  Â  Â  Â  Â  Â  Â  Â  boxShadow: `0 5px 20px ${theme.accent}30`,
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  {isLoading ? (
Â  Â  Â  Â  Â  Â  Â  Â  <span style={{ display: "flex", alignItems: "center", justifyContent: "center", gap: "10px" }}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style={{ animation: "spin 1s linear infinite" }}>â³</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Processing...
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  ) : (
Â  Â  Â  Â  Â  Â  Â  Â  isLogin ? "Sign In" : "Create Account"
Â  Â  Â  Â  Â  Â  Â  )}
Â  Â  Â  Â  Â  Â  </motion.button>

Â  Â  Â  Â  Â  Â  {isLogin && (
Â  Â  Â  Â  Â  Â  Â  <motion.p
Â  Â  Â  Â  Â  Â  Â  Â  whileHover={{ scale: 1.02 }}
Â  Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  Â  marginTop: "12px",
Â  Â  Â  Â  Â  Â  Â  Â  Â  cursor: "pointer",
Â  Â  Â  Â  Â  Â  Â  Â  Â  color: theme.textSecondary,
Â  Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "0.9rem",
Â  Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  Â  textAlign: "right",
Â  Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  Â  onClick={() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  setShowForgotPassword(true);
Â  Â  Â  Â  Â  Â  Â  Â  Â  setMessage("");
Â  Â  Â  Â  Â  Â  Â  Â  Â  setResetEmail(email);
Â  Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Forgot password?
Â  Â  Â  Â  Â  Â  Â  </motion.p>
Â  Â  Â  Â  Â  Â  )}

Â  Â  Â  Â  Â  Â  <motion.p
Â  Â  Â  Â  Â  Â  Â  whileHover={{ scale: 1.02, x: 5 }}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  marginTop: "20px",
Â  Â  Â  Â  Â  Â  Â  Â  cursor: "pointer",
Â  Â  Â  Â  Â  Â  Â  Â  color: theme.accent,
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "0.95rem",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  onClick={() => {
Â  Â  Â  Â  Â  Â  Â  Â  setIsLogin(!isLogin);
Â  Â  Â  Â  Â  Â  Â  Â  setMessage("");
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  {isLogin ? "Don't have an account? Sign up â†’" : "Already have an account? Sign in â†’"}
Â  Â  Â  Â  Â  Â  </motion.p>
Â  Â  Â  Â  Â  </>
Â  Â  Â  Â  ) : (
Â  Â  Â  Â  Â  <>
Â  Â  Â  Â  Â  Â  <motion.input
Â  Â  Â  Â  Â  Â  Â  whileFocus={{ scale: 1.02, boxShadow: `0 0 0 3px ${theme.accent}30` }}
Â  Â  Â  Â  Â  Â  Â  type="email"
Â  Â  Â  Â  Â  Â  Â  placeholder="Enter your email"
Â  Â  Â  Â  Â  Â  Â  value={resetEmail}
Â  Â  Â  Â  Â  Â  Â  onChange={(e) => setResetEmail(e.target.value)}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  width: "100%",
Â  Â  Â  Â  Â  Â  Â  Â  padding: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  marginBottom: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: "14px",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  Â  Â  Â  outline: "none",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  background: theme.background === '#121212' ? 'rgba(0, 0, 0, 0.15)' : 'rgba(0, 0, 0, 0.04)',
Â  Â  Â  Â  Â  Â  Â  Â  color: theme.textPrimary,
Â  Â  Â  Â  Â  Â  Â  Â  border: `1px solid ${theme.border}`,
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  />

Â  Â  Â  Â  Â  Â  <motion.input
Â  Â  Â  Â  Â  Â  Â  whileFocus={{ scale: 1.02, boxShadow: `0 0 0 3px ${theme.accent}30` }}
Â  Â  Â  Â  Â  Â  Â  type="password"
Â  Â  Â  Â  Â  Â  Â  placeholder="New password"
Â  Â  Â  Â  Â  Â  Â  value={newPassword}
Â  Â  Â  Â  Â  Â  Â  onChange={(e) => setNewPassword(e.target.value)}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  width: "100%",
Â  Â  Â  Â  Â  Â  Â  Â  padding: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  marginBottom: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: "14px",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  Â  Â  Â  outline: "none",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  background: theme.background === '#121212' ? 'rgba(0, 0, 0, 0.15)' : 'rgba(0, 0, 0, 0.04)',
Â  Â  Â  Â  Â  Â  Â  Â  color: theme.textPrimary,
Â  Â  Â  Â  Â  Â  Â  Â  border: `1px solid ${theme.border}`,
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  />

Â  Â  Â  Â  Â  Â  <motion.input
Â  Â  Â  Â  Â  Â  Â  whileFocus={{ scale: 1.02, boxShadow: `0 0 0 3px ${theme.accent}30` }}
Â  Â  Â  Â  Â  Â  Â  type="password"
Â  Â  Â  Â  Â  Â  Â  placeholder="Confirm new password"
Â  Â  Â  Â  Â  Â  Â  value={confirmPassword}
Â  Â  Â  Â  Â  Â  Â  onChange={(e) => setConfirmPassword(e.target.value)}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  width: "100%",
Â  Â  Â  Â  Â  Â  Â  Â  padding: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  marginBottom: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: "14px",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  Â  Â  Â  outline: "none",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  background: theme.background === '#121212' ? 'rgba(0, 0, 0, 0.15)' : 'rgba(0, 0, 0, 0.04)',
Â  Â  Â  Â  Â  Â  Â  Â  color: theme.textPrimary,
Â  Â  Â  Â  Â  Â  Â  Â  border: `1px solid ${theme.border}`,
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  />

Â  Â  Â  Â  Â  Â  <motion.button
Â  Â  Â  Â  Â  Â  Â  whileHover={{ scale: 1.05, boxShadow: `0 10px 40px ${theme.accent}40` }}
Â  Â  Â  Â  Â  Â  Â  whileTap={{ scale: 0.95 }}
Â  Â  Â  Â  Â  Â  Â  onClick={handleForgotPassword}
Â  Â  Â  Â  Â  Â  Â  disabled={isLoading}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  width: "100%",
Â  Â  Â  Â  Â  Â  Â  Â  padding: "16px",
Â  Â  Â  Â  Â  Â  Â  Â  borderRadius: "14px",
Â  Â  Â  Â  Â  Â  Â  Â  border: "none",
Â  Â  Â  Â  Â  Â  Â  Â  background: theme.accent,
Â  Â  Â  Â  Â  Â  Â  Â  color: "#fff",
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "600",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "1rem",
Â  Â  Â  Â  Â  Â  Â  Â  cursor: isLoading ? "not-allowed" : "pointer",
Â  Â  Â  Â  Â  Â  Â  Â  letterSpacing: "0.5px",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  Â  opacity: isLoading ? 0.7 : 1,
Â  Â  Â  Â  Â  Â  Â  Â  boxShadow: `0 5px 20px ${theme.accent}30`,
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  {isLoading ? (
Â  Â  Â  Â  Â  Â  Â  Â  <span style={{ display: "flex", alignItems: "center", justifyContent: "center", gap: "10px" }}>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style={{ animation: "spin 1s linear infinite" }}>â³</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Resetting...
Â  Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  ) : (
Â  Â  Â  Â  Â  Â  Â  Â  "Reset Password"
Â  Â  Â  Â  Â  Â  Â  )}
Â  Â  Â  Â  Â  Â  </motion.button>

Â  Â  Â  Â  Â  Â  <motion.p
Â  Â  Â  Â  Â  Â  Â  whileHover={{ scale: 1.02, x: -5 }}
Â  Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  Â  marginTop: "20px",
Â  Â  Â  Â  Â  Â  Â  Â  cursor: "pointer",
Â  Â  Â  Â  Â  Â  Â  Â  color: theme.accent,
Â  Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  Â  Â  fontSize: "0.95rem",
Â  Â  Â  Â  Â  Â  Â  Â  transition: "all 0.3s ease",
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  Â  onClick={() => {
Â  Â  Â  Â  Â  Â  Â  Â  setShowForgotPassword(false);
Â  Â  Â  Â  Â  Â  Â  Â  setMessage("");
Â  Â  Â  Â  Â  Â  Â  Â  setResetEmail("");
Â  Â  Â  Â  Â  Â  Â  Â  setNewPassword("");
Â  Â  Â  Â  Â  Â  Â  Â  setConfirmPassword("");
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  â† Back to Sign In
Â  Â  Â  Â  Â  Â  </motion.p>
Â  Â  Â  Â  Â  </>
Â  Â  Â  Â  )}

Â  Â  Â  Â  {message && (
Â  Â  Â  Â  Â  <motion.div
Â  Â  Â  Â  Â  Â  initial={{ opacity: 0, y: -10 }}
Â  Â  Â  Â  Â  Â  animate={{ opacity: 1, y: 0 }}
Â  Â  Â  Â  Â  Â  style={{
Â  Â  Â  Â  Â  Â  Â  marginTop: "15px",
Â  Â  Â  Â  Â  Â  Â  padding: "12px",
Â  Â  Â  Â  Â  Â  Â  borderRadius: "12px",
Â  Â  Â  Â  Â  Â  Â  background: message.includes("âœ…")
Â  Â  Â  Â  Â  Â  Â  Â  ? "rgba(34, 197, 94, 0.15)"
Â  Â  Â  Â  Â  Â  Â  Â  : "rgba(239, 68, 68, 0.15)",
Â  Â  Â  Â  Â  Â  Â  border: "none",
Â  Â  Â  Â  Â  Â  Â  fontSize: "0.95rem",
Â  Â  Â  Â  Â  Â  Â  color: message.includes("âœ…")
Â  Â  Â  Â  Â  Â  Â  Â  ? "#22c55e"
Â  Â  Â  Â  Â  Â  Â  Â  : "#ef4444",
Â  Â  Â  Â  Â  Â  Â  fontWeight: "500",
Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  {message}
Â  Â  Â  Â  Â  </motion.div>
Â  Â  Â  Â  )}
Â  Â  Â  </motion.div>

Â  Â  Â  {/* Floating Animation Keyframes */}
Â  Â  Â  <style>
Â  Â  Â  Â  {`
Â  Â  Â  Â  Â  @keyframes float {
Â  Â  Â  Â  Â  Â  0%, 100% { transform: translateY(0) translateX(0); }
Â  Â  Â  Â  Â  Â  25% { transform: translateY(-20px) translateX(10px); }
Â  Â  Â  Â  Â  Â  50% { transform: translateY(-10px) translateX(-10px); }
Â  Â  Â  Â  Â  Â  75% { transform: translateY(-30px) translateX(5px); }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  @keyframes spin {
Â  Â  Â  Â  Â  Â  0% { transform: rotate(0deg); }
Â  Â  Â  Â  Â  Â  100% { transform: rotate(360deg); }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  @keyframes particle {
Â  Â  Â  Â  Â  Â  0%, 100% { transform: translateY(0) scale(1); opacity: 0.7; }
Â  Â  Â  Â  Â  Â  25% { transform: translateY(-15px) scale(1.1); opacity: 1; }
Â  Â  Â  Â  Â  Â  50% { transform: translateY(-5px) scale(0.9); opacity: 0.8; }
Â  Â  Â  Â  Â  Â  75% { transform: translateY(-20px) scale(1.05); opacity: 0.9; }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  @keyframes rotate {
Â  Â  Â  Â  Â  Â  0% { transform: translate(-50%, -50%) rotate(0deg); }
Â  Â  Â  Â  Â  Â  100% { transform: translate(-50%, -50%) rotate(360deg); }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  `}
Â  Â  Â  </style>
Â  Â  </div>
Â  );
};

export default Auth;



